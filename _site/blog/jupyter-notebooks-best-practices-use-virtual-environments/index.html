<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Use Virtual Environments Inside Jupyter Notebooks & Jupter Lab [Best Practices] &#8211; Zain Rizvi's blog</title>
<meta name="description" content="Bring the best practices established by the Python community to your Jupyter Notebooks.  You can add virtual environments to Jupyter Lab, giving each notebook it's own environment.  This post goes into detail explaining exactly how you can add virtual environments to your own notebooks on Google Cloud's AI Platform Notebooks">
<meta name="keywords" content="Python, Virtual Environments, Jupyter Lab, technical">




<!-- Twitter Cards -->
<meta name="twitter:title" content="Use Virtual Environments Inside Jupyter Notebooks & Jupter Lab [Best Practices]">
<meta name="twitter:description" content="Bring the best practices established by the Python community to your Jupyter Notebooks.  You can add virtual environments to Jupyter Lab, giving each notebook it's own environment.  This post goes into detail explaining exactly how you can add virtual environments to your own notebooks on Google Cloud's AI Platform Notebooks">
<meta name="twitter:site" content="@zainrzv">
<meta name="twitter:creator" content="@zainrzv">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Use Virtual Environments Inside Jupyter Notebooks & Jupter Lab [Best Practices]">
<meta property="og:description" content="Bring the best practices established by the Python community to your Jupyter Notebooks.  You can add virtual environments to Jupyter Lab, giving each notebook it's own environment.  This post goes into detail explaining exactly how you can add virtual environments to your own notebooks on Google Cloud's AI Platform Notebooks">
<meta property="og:url" content="http://localhost:4000/blog/jupyter-notebooks-best-practices-use-virtual-environments/">
<meta property="og:site_name" content="Zain Rizvi's blog">

<meta property="og:image" content="http://localhost:4000/images/default-thumb.png">






<link rel="canonical" href="http://localhost:4000/blog/jupyter-notebooks-best-practices-use-virtual-environments/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Zain Rizvi's blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<!-- <link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png"> -->
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<!-- <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png"> -->
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<!-- <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png"> -->
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<!-- <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png"> -->

<!-- add the applause button style & script -->
<link rel="stylesheet" href="https://unpkg.com/applause-button/dist/applause-button.css" />
<script src="https://unpkg.com/applause-button/dist/applause-button.js"></script>

<!-- RSS feed metadata -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Zain Rizvi's blog" />

<!-- MailerLite Universal -->
<script>
  (function(m,a,i,l,e,r){ m['MailerLiteObject']=e;function f(){
  var c={ a:arguments,q:[]};var r=this.push(c);return "number"!=typeof r?r:f.bind(c.q);}
  f.q=f.q||[];m[e]=m[e]||f.bind(f.q);m[e].q=m[e].q||f.q;r=a.createElement(i);
  var _=a.getElementsByTagName(i)[0];r.async=1;r.src=l+'?v'+(~~(new Date().getTime()/1000000));
  _.parentNode.insertBefore(r,_);})(window, document, 'script', 'https://static.mailerlite.com/js/universal.js', 'ml');

  var ml_account = ml('accounts', '1765926', 's9l3w3n7b0', 'load');
</script>
<!-- End MailerLite Universal -->

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000/">Zain Rizvi's blog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav id="site-nav" class="nav">
		    <ul>
		        
				    
				    <li><a href="http://localhost:4000/blog/" >Blog</a></li>
				
				    
				    <li><a href="http://localhost:4000/about/" >About</a></li>
				
				<li>
					<a href="http://localhost:4000/feed.xml"><img src="/images/rss.png" alt="rss feed" height=20 width=20/></a>
				</li>
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->




<div id="main" role="main">
  <div class="article-author-side">
    

<div itemscope itemtype="http://schema.org/Person">


	<img src="http://localhost:4000/images/bio-photo.png" class="bio-photo" alt="Zain Rizvi bio photo">


  <h3 itemprop="name">Zain Rizvi</h3>
  <p>Software Engineer, Experimenter, Life-long Student. Working at Google improving GCP AI Platform Notebooks</p>
  
  <a href="//twitter.com/zainrzv" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  
  
  
  
  
  <a href="http://github.com/ZainRizvi" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  <a href="//stackoverflow.com/users/21539/zain-rizvi" class="author-social" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i> Stackoverflow</a>
  
  
  
  
  
  
  
  
  
  
  <a href="//techstuff.buzzsprout.com" class="author-social" target="_blank"><i class="fa fa-fw"></i> Podcast: Tech Stuff</a>
</div>
<hr />
<div class="ml-form-embed"
  data-account="1765926:s9l3w3n7b0"
  data-form="1616786:y5z4v2">
</div>

    <hr />
    <!-- https://applause-button.com/ -->

    <div style="margin:0 auto; width: 58px" >
    <applause-button style="width: 58px; height: 58px; align-content: center" multiclap="true"/>
    </div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://localhost:4000/blog/jupyter-notebooks-best-practices-use-virtual-environments/" rel="bookmark" title="Use Virtual Environments Inside Jupyter Notebooks & Jupter Lab [Best Practices]">Use Virtual Environments Inside Jupyter Notebooks & Jupter Lab [Best Practices]</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>iUsing Virtual Environments has become a standard best practice in the Python community.  They allow you to work on multiple python projects at the same time, without one accidentally corrupting the dependencies of another.  While using these Virtual Environments has become the norm with Python projects, they haven’t yet caught on in Python notebooks.  However, they’re easy to add to your Jupyter Notebook or Jupyter Lab setup.  This post will describe just how you can use them.</p>

<h1 id="what-will-this-enable-you-to-do">What will this enable you to do?</h1>

<p>By following these steps, you can have multiple notebooks running on the same machine in Jupyter Lab, where each notebook uses own versions of potentially conflicting python packages.</p>

<p>We’ll do this by creating an isolated python virtual environment for each notebook, so that each notebooks runs inside it’s own environment.</p>

<p>If you’re using Google’s <a href="https://cloud.google.com/ai-platform-notebooks/">AI Platform Notebooks</a>, the scripts below will allow you to keep using the awesome deep learning packages that come pre-installed on them, while isolating each of your notebooks from any new packages you install for any other notebook.</p>

<h1 id="why-does-it-matter">Why does it matter?</h1>

<p><strong>Benefit from established Python best practices!</strong>  Having each project in a separate virtual environment is an existing best practice for python projects, so it seems logical to extend this behavior to python notebooks as well.   Of course, this will only apply to Python notebooks and not notebooks using other languages</p>

<h1 id="how-do-you-set-it-up">How do you set it up?</h1>

<p>First you’ll need a Jupyter Lab notebook environment.  If you don’t have one already you can quickly create one us Google Cloud’s <a href="https://cloud.google.com/ai-platform-notebooks/">AI Platform Notebooks</a></p>

<p>Go to your Jupyter Lab notebook and in it’s terminal enter the following (replacing “myenv” with whatever name you want to give your environment):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># You only need to run this command once per-VM
sudo apt-get install python3-venv -y

# The rest of theses steps should be run every time you create
#  a new notebook (and want a virutal environment for it)

cd the/directory/your/notebook/will/be/in

# Create the virtual environment
# The '--system-site-packages' flag allows the python packages 
#  we installed by default to remain accessible in the virtual 
#  environment.  It's best to use this flag if you're doing this
#  on AI Platform Notebooks so that you keep all the pre-baked 
#  goodness
python3 -m venv myenv --system-site-packages
source myenv/bin/activate #activate the virtual env

# Register this env with jupyter lab. It’ll now show up in the
#  launcher &amp; kernels list once you refresh the page
python -m ipykernel install --user --name=myenv

# Any python packages you pip install now will persist only in
#  this environment_
deactivate # exit the virtual env
</code></pre></div></div>

<p>After running the above code, you’ll need to <strong>refresh your JupyterLab tab for the changes to be visible</strong></p>

<h1 id="the-results">The Results</h1>

<p>Here’s my launcher after I added two customized environments (“myenv” and “zainsenv”).</p>

<p><img src="/media/2019-11-08-launcher.png" alt="" /></p>

<p>And if you try to switch kernels from within a notebook, you’ll see the virtual environments availalbe as kernels for you to use</p>

<p><img src="/media/2019-11-08-kernels.png" alt="" /></p>

<h1 id="see-it-in-action">See it in Action</h1>

<p>Here you can see I installed the pytube package in one environment</p>

<p><img src="/media/2019-11-08-pasted image 0.png" alt="" /></p>

<p>That package was not visible in the other environment.  And then when I installed an older version of the same package in the second environment (let’s pretend it needed the older version). The first environment kept using the newer version of the package</p>

<p><img src="/media/2019-11-08-pasted image 0 (1).png" alt="" /></p>

<p>And there you have it.  You can now create virtual environments on your Jupyter Lab notebooks</p>

      <hr />
      <br/>
      <!-- https://applause-button.com/ -->

    <div style="margin:0 auto; width: 58px" >
    <applause-button style="width: 58px; height: 58px; align-content: center" multiclap="true"/>
    </div>

      <br/>
      <div class="ml-form-embed"
  data-account="1765926:s9l3w3n7b0"
  data-form="1616590:u0m8l0">
</div>


      <hr/>

      <footer role="contentinfo">
        
<!--
<div class="social-share">
  <h5>Thanks for reading! If you found this post valuable, your followers might also like it</h5>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/blog/jupyter-notebooks-best-practices-use-virtual-environments/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/blog/jupyter-notebooks-best-practices-use-virtual-environments/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
  </ul>
</div>
-->
<!-- /.social-share -->

        <p class="byline"><strong>Use Virtual Environments Inside Jupyter Notebooks & Jupter Lab [Best Practices]</strong> was published on <time datetime="2019-11-08T00:00:00-08:00">November 08, 2019</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->


  
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/blog/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://localhost:4000/blog/authenticating-ai-platform-notebooks-against-bigquery-in-python/" title="Authenticating AI Platform Notebooks against BigQuery in Python">Authenticating AI Platform Notebooks against BigQuery in Python</a></li>
    
      <li><a href="http://localhost:4000/blog/a-more-beautiful-question-summary/" title="A More Beautiful Question - Key Insights">A More Beautiful Question - Key Insights</a></li>
    
      <li><a href="http://localhost:4000/blog/so-good-they-can-t-ignore-you-key-ideas/" title="So Good They Can't Ignore You - Key Ideas">So Good They Can't Ignore You - Key Ideas</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2019 Zain Rizvi. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'zainrizvi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63901701-1', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>
